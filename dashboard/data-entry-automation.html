<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Entry & Automation - OOES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .automation-card { transition: all 0.3s ease; cursor: pointer; }
        .automation-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .workflow-step { display: flex; align-items: center; margin-bottom: 10px; }
        .step-number { width: 40px; height: 40px; border-radius: 50%; background: #4f46e5; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; }
        .step-content { flex: 1; }
        .progress-bar { height: 8px; background: #e5e7eb; border-radius: 4px; transition: width 0.3s ease; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .tab-button { transition: all 0.2s ease; border: 1px solid #e5e7eb; background: white; padding: 8px 16px; border-radius: 4px; }
        .tab-button:hover { background-color: #4f46e5; }
        .tab-button.active { background-color: #10b981; color: white; }
        .status-badge { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; }
        .status-active { background-color: #10b981; color: white; }
        .status-pending { background-color: #f59e0b; color: white; }
        .status-completed { background-color: #10b981; color: white; }
        .status-processing { background-color: #3b82f6; color: white; }
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th { background: #f3f4f6; color: white; padding: 12px; text-align: left; font-weight: 600; }
        .data-table td { padding: 12px; border: 1px solid #e5e7eb; }
        .data-table tr:hover { background-color: #f9fafb; }
        .success-message { background: #10b981; color: white; padding: 16px; border-radius: 8px; margin: 8px 0; }
        .error-message { background: #ef4444; color: white; padding: 16px; border-radius: 8px; margin: 8px 0; }
        .field-input { width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; }
        .field-input:focus { outline: none; border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-robot text-3xl mr-4"></i>
                    <div>
                        <h1 class="text-2xl font-bold">Data Entry & Automation</h1>
                        <p class="text-green-100">Intelligent Automation Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-sm text-gray-300">System Status</p>
                        <p class="text-lg font-bold text-green-400">Active</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm text-gray-300">Automations</p>
                        <p class="text-lg font-bold text-blue-600">12 Running</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm text-gray-300">Data Processed</p>
                        <p class="text-lg font-bold text-purple-600">1.2M Records</p>
                    </div>
                    <button onclick="goBack()" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Automation Overview -->
        <section class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-cogs mr-3 text-purple-600"></i>
                    Automation Overview
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Active Automations -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                        <div class="flex items-center justify-between mb-4">
                            <i class="fas fa-play-circle text-3xl text-green-600"></i>
                            <span class="status-badge status-active">4</span>
                        </div>
                        <h3 class="text-lg font-bold text-green-800 mb-2">Active Automations</h3>
                        <p class="text-green-700">Currently running automations</p>
                    </div>
                    </div>
                    
                    <!-- Data Processing Stats -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                        <div class="flex items-center justify-between mb-4">
                            <i class="fas fa-database text-3xl text-blue-600"></i>
                            <span class="status-badge status-active">1.2M</span>
                        </div>
                        <h3 class="text-lg font-bold text-blue-800 mb-2">Records Processed</h3>
                        <p class="text-blue-700">Total data records processed</p>
                    </div>
                    </div>
                    
                    <!-- Time Saved -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                        <div class="flex items-center justify-between mb-4">
                            <i class="fas fa-clock text-3xl text-purple-600"></i>
                            <span class="status-badge status-active">850</span>
                        </div>
                        <h3 class="text-lg font-bold text-purple-800 mb-2">Hours Saved Monthly</h3>
                        <p class="text-purple-700">Through automation and data entry</p>
                    </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Entry Tools -->
        <section class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-keyboard text-blue-600"></i>
                    Data Entry Tools
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Form Builder -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                        <h3 class="text-lg font-bold text-blue-800 mb-4">Smart Form Builder</h3>
                        <p class="text-blue-700">Create custom data entry forms with validation</p>
                        <button onclick="openFormBuilder()" class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition font-semibold">
                            <i class="fas fa-wpforms mr-2"></i>Launch Form Builder
                        </button>
                    </div>
                    
                    <!-- Data Import/Export -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                        <h3 class="text-lg font-bold text-green-800 mb-4">Data Import/Export</h3>
                        <p class="text-green-700">Import CSV, Excel, or database files</p>
                        <div class="space-y-2">
                            <input type="file" id="importFile" class="field-input" accept=".csv,.xlsx,.json" multiple>
                            <button onclick="importData()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition">
                                <i class="fas fa-upload mr-2"></i>Import Data
                            </button>
                            <button onclick="exportData()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
                                <i class="fas fa-download mr-2"></i>Export Data
                            </button>
                        </div>
                    </div>
                    
                    <!-- OCR Processing -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                        <h3 class="text-lg font-bold text-purple-800 mb-4">OCR Document Processing</h3>
                        <p class="text-purple-700">Convert scanned documents to editable text</p>
                        <div class="space-y-2">
                            <input type="file" id="ocrFile" class="field-input" accept="image/*,.pdf">
                            <button onclick="processOCR()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition">
                                <i class="fas fa-camera mr-2"></i>Scan & Process
                            </button>
                        </div>
                    </div>
                    
                    <!-- Validation Rules -->
                    <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-lg border border-yellow-200">
                        <h3 class="text-lg font-bold text-yellow-800 mb-4">Validation Rules Engine</h3>
                        <p class="text-yellow-700">Custom validation rules for data quality</p>
                        <button onclick="openValidationRules()" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition">
                            <i class="fas fa-check-circle mr-2"></i>Configure Rules
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workflow Automation -->
        <section class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-project-diagram mr-3 text-indigo-600"></i>
                    Workflow Automation
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Workflow Templates -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-lg border border-indigo-200">
                        <h3 class="text-lg font-bold text-indigo-800 mb-4">Workflow Templates</h3>
                        <p class="text-indigo-700">Pre-built automation workflows for common tasks</p>
                        <div class="space-y-2">
                            <button onclick="useTemplate('onboarding')" class="w-full bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition">
                                <i class="fas fa-user-plus mr-2"></i>Employee Onboarding
                            </button>
                            <button onclick="useTemplate('invoice-processing')" class="w-full bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition">
                                <i class="fas fa-file-invoice mr-2"></i>Invoice Processing
                            </button>
                            <button onclick="useTemplate('data-cleanup')" class="w-full bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition">
                                <i class="fas fa-broom mr-2"></i>Data Cleanup
                            </button>
                        </div>
                    </div>
                    
                    <!-- Custom Workflow Builder -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                        <h3 class="text-lg font-bold text-purple-800 mb-4">Workflow Builder</h3>
                        <p class="text-purple-700">Create custom automation workflows with drag-and-drop interface</p>
                        <button onclick="openWorkflowBuilder()" class="w-full bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition">
                            <i class="fas fa-sitemap mr-2"></i>Build Workflow
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Monitoring & Analytics -->
        <section class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-chart-line mr-3 text-orange-600"></i>
                    Monitoring & Analytics
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Real-time Dashboard -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200">
                        <h3 class="text-lg font-bold text-orange-800 mb-4">Real-time Dashboard</h3>
                        <p class="text-orange-700">Monitor all automations and data flows</p>
                        <div id="realtimeStats" class="space-y-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-600">Active Tasks:</span>
                                <span class="status-badge status-active">8</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Success Rate:</span>
                                <span class="text-green-600 font-bold">98.5%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Errors:</span>
                                <span class="text-red-600 font-bold">1.5%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-lg border-red-200">
                        <h3 class="text-lg font-bold text-red-800 mb-4">Performance Metrics</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-600">Processing Speed:</span>
                                <span class="text-green-600 font-bold">2.3s avg</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Accuracy:</span>
                                <span class="text-green-600 font-bold">99.7%</span>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-bolt mr-3 text-yellow-600"></i>
                    Quick Actions
                </h2>
                
                <div class="flex flex-wrap gap-4">
                    <button onclick="runAllAutomations()" class="bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700 transition font-semibold">
                        <i class="fas fa-play mr-2"></i>Run All Automations
                    </button>
                    <button onclick="pauseAllAutomations()" class="bg-yellow-600 text-white px-4 py-3 rounded hover:bg-yellow-700 transition font-semibold">
                        <i class="fas fa-pause mr-2"></i>Pause All
                    </button>
                    <button onclick="generateReport()" class="bg-blue-600 text-white px-4 py-3 rounded hover:bg-blue-700 transition font-semibold">
                        <i class="fas fa-file-alt mr-2"></i>Generate Report
                    </button>
                    <button onclick="scheduleAutomation()" class="bg-purple-600 text-white px-4 py-3 rounded hover:bg-purple-700 transition font-semibold">
                        <i class="fas fa-calendar-alt mr-2"></i>Schedule Tasks
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Automation Modal -->
    <div id="automationModal" class="modal">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden m-4">
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6">
                <div class="flex justify-between items-center">
                    <h3 id="modalTitle" class="text-xl font-bold">Automation Configuration</h3>
                    <button onclick="closeAutomationModal()" class="text-white hover:text-gray-200">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-8">
                <div class="space-y-6">
                    <!-- Automation Type -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Automation Type:</label>
                        <select id="automationType" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">Select Type</option>
                            <option value="data-entry">Data Entry Automation</option>
                            <option value="email-automation">Email Automation</option>
                            <option value="file-processing">File Processing</option>
                            <option value="web-scraping">Web Scraping</option>
                            <option value="api-integration">API Integration</option>
                            <option value="scheduled-tasks">Scheduled Tasks</option>
                        </select>
                    </div>
                    
                    <!-- Trigger Configuration -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Trigger:</label>
                        <select id="triggerType" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">Select Trigger</option>
                            <option value="manual">Manual</option>
                            <option value="schedule">Scheduled</option>
                            <option value="event-based">Event-Based</option>
                            <option value="data-change">Data Change</option>
                            <option value="webhook">Webhook</option>
                        </select>
                    </div>
                    
                    <!-- Action Configuration -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Action:</label>
                        <select id="actionType" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">Select Action</option>
                            <option value="send-email">Send Email</option>
                            <option value="create-record">Create Record</option>
                            <option value="update-record">Update Record</option>
                            <option value="delete-record">Delete Record</option>
                            <option value="export-data">Export Data</option>
                            <option value="api-call">API Call</option>
                            <option value="run-script">Run Script</option>
                        </select>
                    </div>
                    
                    <!-- Schedule -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Schedule:</label>
                        <input type="datetime-local" id="scheduleTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                        <select id="scheduleFrequency" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="once">Once</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    
                    <!-- Save Button -->
                    <div class="mt-6">
                        <button onclick="saveAutomation()" class="w-full bg-indigo-600 text-white px-6 py-3 rounded hover:bg-indigo-700 transition font-semibold">
                            <i class="fas fa-save mr-2"></i>Save Automation
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script>
        // Data Entry & Automation System
        let automations = [];
        let currentAutomationId = null;

        function initializeAutomationSystem() {
            updateAutomationStats();
            renderAutomationsList();
        }

        function updateAutomationStats() {
            const activeCount = automations.filter(auto => auto.status === 'active').length;
            const totalProcessed = automations.reduce((sum, auto) => sum + (auto.recordsProcessed || 0), 0);
            const successRate = automations.length > 0 ? (automations.filter(auto => auto.status === 'completed').length / automations.length * 100).toFixed(1) : 0;
            
            // Update display elements
            document.querySelector('.text-lg.text-blue-600').textContent = activeCount;
            document.querySelector('.text-lg.text-blue-600').textContent = totalProcessed.toLocaleString();
            document.querySelector('.text-lg.text-purple-600').textContent = successRate.toFixed(1) + '%';
        }

        function renderAutomationsList() {
            const automationList = document.getElementById('automationList');
            automationList.innerHTML = automations.map(automation => `
                <div class="automation-card bg-white rounded-lg p-4 border border-gray-200">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h4 class="text-lg font-bold text-gray-800">${automation.name}</h4>
                            <div class="flex items-center space-x-2">
                                <span class="status-badge ${automation.status === 'active' ? 'status-active' : automation.status === 'completed' ? 'status-completed' : 'status-pending'}">
                                    ${automation.status.charAt(0).toUpperCase() + automation.status.slice(1)}
                                </span>
                            </div>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            Type: ${automation.type}<br>
                            Records: ${automation.recordsProcessed || 0} processed<br>
                            Created: ${new Date(automation.createdAt).toLocaleDateString()}<br>
                            Last Run: ${automation.lastRun ? new Date(automation.lastRun).toLocaleDateString() : 'Never'}
                        </div>
                        </div>
                        <div class="flex justify-between">
                            <button onclick="editAutomation(${automation.id})" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteAutomation(${automation.id})" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openFormBuilder() {
            document.getElementById('modalTitle').textContent = 'Smart Form Builder';
            document.getElementById('automationModal').classList.add('active');
        }

        function openValidationRules() {
            document.getElementById('modalTitle').textContent = 'Validation Rules Engine';
            document.getElementById('automationModal').classList.add('active');
        }

        function openWorkflowBuilder() {
            document.getElementById('modalTitle').textContent = 'Workflow Builder';
            document.getElementById('automationModal').classList.add('active');
        }

        function editAutomation(id) {
            const automation = automations.find(auto => auto.id === id);
            if (automation) {
                document.getElementById('automationType').value = automation.type;
                document.getElementById('triggerType').value = automation.trigger;
                document.getElementById('actionType').value = automation.action;
                document.getElementById('scheduleTime').value = automation.schedule;
                document.getElementById('scheduleFrequency').value = automation.frequency;
                document.getElementById('modalTitle').textContent = 'Edit Automation';
                document.getElementById('automationModal').classList.add('active');
            }
        }

        function deleteAutomation(id) {
            if (confirm('Are you sure you want to delete this automation?')) {
                automations = automations.filter(auto => auto.id !== id);
                renderAutomationsList();
                updateAutomationStats();
                alert('Automation deleted successfully!');
            }
        }

        function saveAutomation() {
            const automation = {
                id: automations.length + 1,
                name: document.getElementById('automationName') ? document.getElementById('automationName').value : `Automation ${automations.length + 1}`,
                type: document.getElementById('automationType').value,
                trigger: document.getElementById('triggerType').value,
                action: document.getElementById('actionType').value,
                schedule: document.getElementById('scheduleTime').value,
                frequency: document.getElementById('scheduleFrequency').value,
                status: 'active',
                createdAt: new Date().toISOString(),
                recordsProcessed: 0,
                lastRun: null
            };
            
            automations.push(automation);
            renderAutomationsList();
            updateAutomationStats();
            closeAutomationModal();
            alert('Automation saved successfully!');
        }

        function runAllAutomations() {
            alert('Running all active automations...');
            // Simulate running all automations
            setTimeout(() => {
                automations.forEach(automation => {
                    automation.status = 'processing';
                    automation.recordsProcessed += Math.floor(Math.random() * 100) + 50;
                    automation.lastRun = new Date();
                });
                });
                renderAutomationsList();
                updateAutomationStats();
                alert('All automations completed!');
            }, 3000);
        }

        function pauseAllAutomations() {
            automations.forEach(automation => {
                if (automation.status === 'active') {
                    automation.status = 'paused';
                }
            });
            renderAutomationsList();
            updateAutomationStats();
            alert('All automations paused!');
        }

        function generateReport() {
            const reportData = {
                totalAutomations: automations.length,
                activeAutomations: automations.filter(auto => auto.status === 'active').length,
                completedAutomations: automations.filter(auto => auto.status === 'completed').length,
                totalProcessed: automations.reduce((sum, auto) => sum + (auto.recordsProcessed || 0), 0),
                averageProcessed: automations.length > 0 ? (automations.reduce((sum, auto) => sum + (auto.recordsProcessed || 0), 0) / automations.length : 0),
                reportDate: new Date().toISOString()
            };
            
            console.log('Automation Report:', reportData);
            alert('Report generated successfully!');
        }

        function scheduleAutomation() {
            alert('Automation scheduler opened...');
        }

        function closeAutomationModal() {
            document.getElementById('automationModal').classList.remove('active');
        }

        function importData() {
            const fileInput = document.getElementById('importFile');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const data = e.target.result;
                    // Parse CSV or JSON data
                    const lines = data.split('\n');
                    const records = lines.map(line => {
                        const values = line.split(',');
                        return {
                            firstName: values[0] || '',
                            lastName: values[1] || '',
                            email: values[2] || '',
                            department: values[3] || 'General',
                            position: values[4] || '',
                            startDate: values[5] || new Date().toISOString().split('T')[0]
                        };
                    });
                    
                    // Add records to system
                    records.forEach(record => {
                        const newRecord = {
                            id: Date.now(),
                            ...record,
                            importedAt: new Date().toISOString(),
                            status: 'imported'
                        };
                        // In real implementation, this would add to database
                        console.log('Imported Record:', newRecord);
                    });
                    
                    alert(`Successfully imported ${records.length} records!`);
                    fileInput.value = '';
                };
                
                reader.readAsText(file);
            }
        }

        function exportData() {
            const data = automations.map(auto => ({
                id: auto.id,
                name: auto.name,
                type: auto.type,
                status: auto.status,
                recordsProcessed: auto.recordsProcessed,
                createdAt: auto.createdAt,
                lastRun: auto.lastRun
            }));
            
            // Create CSV download
            const csv = [
                ['ID', 'Name', 'Type', 'Status', 'Records Processed', 'Created At', 'Last Run', 'Success Rate'],
                ...data.map(auto => [auto.id, auto.name, auto.type, auto.status, auto.recordsProcessed, auto.createdAt, auto.lastRun])
            ];
            
            const csvContent = csv.map(row => row.join(',')).join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'automation-report.csv';
            a.textContent = 'Download Automation Report';
            a.click();
        }

        function processOCR() {
            const fileInput = document.getElementById('ocrFile');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    // Simulate OCR processing
                    setTimeout(() => {
                        alert(`OCR processing completed for ${file.name}. Text extracted and ready for data entry.`);
                    }, 2000);
                };
                
                reader.readAsDataURL(file);
            }
        }

        function useTemplate(templateType) {
            const templates = {
                'onboarding': {
                    name: 'Employee Onboarding Workflow',
                    type: 'email-automation',
                    trigger: 'manual',
                    action: 'send-email',
                    schedule: 'once',
                    frequency: 'once',
                    steps: [
                        'Send welcome email to new employee',
                        'Schedule orientation session',
                        'Create employee records',
                        'Assign equipment and access'
                    ]
                },
                'invoice-processing': {
                    name: 'Invoice Processing Workflow',
                    type: 'file-processing',
                    trigger: 'manual',
                    action: 'create-record',
                    schedule: 'daily',
                    frequency: 'daily',
                    steps: [
                        'Generate invoice from timesheet data',
                        'Send invoice to client',
                        'Update accounting system',
                        'Record payment received'
                    ]
                },
                'data-cleanup': {
                    name: 'Data Cleanup Workflow',
                    type: 'data-entry',
                    trigger: 'scheduled',
                    action: 'update-record',
                    schedule: 'weekly',
                    frequency: 'weekly',
                    steps: [
                        'Identify duplicate records',
                        'Archive old data',
                        'Update inconsistent entries',
                        'Generate cleanup report'
                    ]
                }
            };
            
            const template = templates[templateType];
            if (template) {
                document.getElementById('automationName').value = template.name;
                document.getElementById('automationType').value = template.type;
                document.getElementById('triggerType').value = template.trigger;
                document.getElementById('actionType').value = template.action;
                document.getElementById('scheduleTime').value = template.schedule;
                document.getElementById('scheduleFrequency').value = template.frequency;
                document.getElementById('modalTitle').textContent = 'Configure Template';
                document.getElementById('automationModal').classList.add('active');
            }
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeAutomationSystem);
    </script>
</body>
</html>
