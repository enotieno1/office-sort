<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Email System - OOES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .email-item { transition: all 0.3s ease; cursor: pointer; }
        .email-item:hover { transform: translateX(5px); background-color: #f3f4f6; }
        .compose-area { min-height: 400px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .toolbar-btn { transition: all 0.2s ease; }
        .toolbar-btn:hover { background-color: #e5e7eb; transform: scale(1.05); }
        .toolbar-btn.active { background-color: #3b82f6; color: white; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-envelope text-3xl mr-4"></i>
                    <div>
                        <h1 class="text-2xl font-bold">Professional Email System</h1>
                        <p class="text-indigo-100">OOES Business Communications</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-sm text-gray-300">Business Email</p>
                        <p class="text-lg font-bold">contact@ooes.co.ke</p>
                        <p class="text-sm text-gray-300">+254 717 261 425</p>
                    </div>
                    <button onclick="goBack()" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-arrow-left mr-2"></i>Back
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Professional Email System Header -->
        <div class="bg-white rounded-lg shadow-md p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">
                <i class="fas fa-envelope mr-3 text-blue-600"></i>
                Professional Email System
            </h2>
            
            <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                <p class="text-blue-800 font-semibold mb-2">
                    <i class="fas fa-at mr-2"></i>
                    Business Communications Hub
                </p>
                <p class="text-blue-700 text-sm">Professional email system with templates, auto-responses, and client management. Contact: <strong>+254 717 261 425</strong> | <strong>contact@ooes.co.ke</strong></p>
            </div>
        </div>

        <!-- Email System Activities Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <!-- Email Compose Activity -->
            <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden" onclick="focusCompose()">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Email Compose</h3>
                        <span class="text-sm text-gray-500">Rich Text Editor</span>
                    </div>
                    <div class="flex space-x-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Active</span>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">12 Drafts</span>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <i class="fas fa-pen text-3xl text-blue-600 mr-3"></i>
                    <i class="fas fa-clock text-sm text-gray-500 mr-2"></i>
                    <span class="text-sm text-gray-600">Last compose: 10 min ago</span>
                </div>
            </div>
            <p class="text-gray-600 text-sm mb-4">Advanced email composer with rich text formatting, attachments, and professional templates.</p>
            <button onclick="focusCompose()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition font-semibold">
                <i class="fas fa-arrow-right mr-2"></i>Compose Email
            </button>
            </div>
            
            <!-- Email Templates Activity -->
            <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden" onclick="scrollToTemplates()">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Email Templates</h3>
                        <span class="text-sm text-gray-500">4 Templates</span>
                    </div>
                    <div class="flex space-x-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Active</span>
                        <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs">Professional</span>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <i class="fas fa-file-alt text-3xl text-green-600 mr-3"></i>
                    <i class="fas fa-clock text-sm text-gray-500 mr-2"></i>
                    <span class="text-sm text-gray-600">Last used: 1 hour ago</span>
                </div>
            </div>
            <p class="text-gray-600 text-sm mb-4">Professional email templates for welcome messages, follow-ups, invoices, and meeting requests.</p>
            <button onclick="scrollToTemplates()" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition font-semibold">
                <i class="fas fa-arrow-right mr-2"></i>View Templates
            </button>
            </div>
            
            <!-- Email Analytics Activity -->
            <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden" onclick="viewEmailAnalytics()">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Email Analytics</h3>
                        <span class="text-sm text-gray-500">1.8K Sent</span>
                    </div>
                    <div class="flex space-x-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Active</span>
                        <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs">98% Delivered</span>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <i class="fas fa-chart-line text-3xl text-purple-600 mr-3"></i>
                    <i class="fas fa-clock text-sm text-gray-500 mr-2"></i>
                    <span class="text-sm text-gray-600">Last report: Today</span>
                </div>
            </div>
            <p class="text-gray-600 text-sm mb-4">Comprehensive email analytics with delivery tracking, open rates, and response metrics.</p>
            <button onclick="viewEmailAnalytics()" class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition font-semibold">
                <i class="fas fa-arrow-right mr-2"></i>View Analytics
            </button>
            </div>
        </div>

        <!-- Quick Actions Section -->
        <div class="bg-white rounded-lg shadow-md p-8 mb-8">
            <h3 class="text-xl font-bold mb-6 text-gray-800">
                <i class="fas fa-bolt mr-3 text-blue-600"></i>
                Quick Actions
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                    <button onclick="checkEmail(this)" class="w-full bg-blue-500 text-white px-6 py-4 rounded-lg hover:bg-blue-600 transition-all mb-3">
                        <i class="fas fa-sync text-2xl mb-2"></i>
                        <div class="font-semibold">Check New Email</div>
                    </button>
                    <p class="text-sm text-gray-600">Instantly check for new messages and update inbox</p>
                </div>
                <div class="text-center">
                    <button onclick="composeNew(this)" class="w-full bg-green-500 text-white px-6 py-4 rounded-lg hover:bg-green-600 transition-all mb-3">
                        <i class="fas fa-plus text-2xl mb-2"></i>
                        <div class="font-semibold">Compose New</div>
                    </button>
                    <p class="text-sm text-gray-600">Start composing a new professional email</p>
                </div>
                <div class="text-center">
                    <button onclick="viewCalendar(this)" class="w-full bg-purple-500 text-white px-6 py-4 rounded-lg hover:bg-purple-600 transition-all mb-3">
                        <i class="fas fa-calendar text-2xl mb-2"></i>
                        <div class="font-semibold">View Calendar</div>
                    </button>
                    <p class="text-sm text-gray-600">Access your calendar and schedule meetings</p>
                </div>
            </div>
        </div>

        <!-- Email Compose Section -->
        <div id="composeSection" class="bg-white rounded-lg shadow-md p-8 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-pen mr-2"></i>Compose Email
                </h3>
                <div class="flex space-x-2">
                    <button onclick="saveDraft()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition">
                        <i class="fas fa-save mr-1"></i>Save Draft
                    </button>
                    <button onclick="sendEmail()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition">
                        <i class="fas fa-paper-plane mr-1"></i>Send
                    </button>
                </div>
            </div>

            <!-- Email Form -->
            <form id="emailForm" class="space-y-4" onsubmit="return validateForm(this)">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">To:</label>
                        <input type="email" id="toEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="recipient@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">CC:</label>
                        <input type="email" id="ccEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="cc@example.com">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Subject:</label>
                    <input type="text" id="subject" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Email subject">
                </div>
                
                <!-- Email Toolbar -->
                <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                    <div class="flex flex-wrap gap-2">
                        <button type="button" onclick="formatText('bold')" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button type="button" onclick="formatText('italic')" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button type="button" onclick="formatText('underline')" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-underline"></i>
                        </button>
                        <div class="border-l border-gray-300 mx-2"></div>
                        <button type="button" onclick="addLink()" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-link"></i>
                        </button>
                        <button type="button" onclick="addImage()" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-image"></i>
                        </button>
                        <button type="button" onclick="addAttachment()" class="toolbar-btn p-2 rounded hover:bg-gray-200 transition">
                            <i class="fas fa-paperclip"></i>
                        </button>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Message:</label>
                    <div id="emailBody" contenteditable="true" class="compose-area w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-h-[300px]" placeholder="Type your message here..."></div>
                </div>
                
                <!-- Attachments -->
                <div id="attachments" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Attachments:</label>
                    <div id="attachmentList" class="space-y-2"></div>
                </div>
            </form>
        </div>

        <!-- Email Templates Section -->
        <div id="templatesSection" class="bg-white rounded-lg shadow-md p-8 mb-8">
            <h3 class="text-xl font-bold mb-6 text-gray-800">
                <i class="fas fa-file-alt mr-2 text-blue-600"></i>Quick Templates
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden border border-blue-200" onclick="useTemplate('welcome')">
                    <div class="p-4 text-center">
                        <i class="fas fa-handshake text-blue-500 text-3xl mb-3"></i>
                        <h4 class="font-bold text-gray-800 mb-1">Welcome Message</h4>
                        <p class="text-sm text-gray-600">New client onboarding</p>
                    </div>
                </div>
                <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden border border-green-200" onclick="useTemplate('followup')">
                    <div class="p-4 text-center">
                        <i class="fas fa-phone text-green-500 text-3xl mb-3"></i>
                        <h4 class="font-bold text-gray-800 mb-1">Follow-up</h4>
                        <p class="text-sm text-gray-600">Meeting follow-up</p>
                    </div>
                </div>
                <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden border border-yellow-200" onclick="useTemplate('invoice')">
                    <div class="p-4 text-center">
                        <i class="fas fa-file-invoice text-yellow-500 text-3xl mb-3"></i>
                        <h4 class="font-bold text-gray-800 mb-1">Invoice Notice</h4>
                        <p class="text-sm text-gray-600">Payment reminder</p>
                    </div>
                </div>
                <div class="activity-card bg-white rounded-xl shadow-lg overflow-hidden border border-purple-200" onclick="useTemplate('meeting')">
                    <div class="p-4 text-center">
                        <i class="fas fa-calendar text-purple-500 text-3xl mb-3"></i>
                        <h4 class="font-bold text-gray-800 mb-1">Meeting Request</h4>
                        <p class="text-sm text-gray-600">Schedule meeting</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Statistics Section -->
        <div class="bg-white rounded-lg shadow-md p-8">
            <h3 class="text-xl font-bold mb-6 text-gray-800">
                <i class="fas fa-chart-bar mr-2 text-blue-600"></i>Email Statistics
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="text-center">
                    <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                        <i class="fas fa-inbox text-blue-600 text-3xl mb-3"></i>
                        <div class="text-2xl font-bold text-blue-600">247</div>
                        <div class="text-sm text-gray-600">Inbox Messages</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                        <i class="fas fa-paper-plane text-green-600 text-3xl mb-3"></i>
                        <div class="text-2xl font-bold text-green-600">1,823</div>
                        <div class="text-sm text-gray-600">Sent Emails</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-yellow-50 p-6 rounded-lg border border-yellow-200">
                        <i class="fas fa-file-alt text-yellow-600 text-3xl mb-3"></i>
                        <div class="text-2xl font-bold text-yellow-600">12</div>
                        <div class="text-sm text-gray-600">Draft Messages</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-purple-50 p-6 rounded-lg border border-purple-200">
                        <i class="fas fa-archive text-purple-600 text-3xl mb-3"></i>
                        <div class="text-2xl font-bold text-purple-600">3,456</div>
                        <div class="text-sm text-gray-600">Archived Emails</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Email Preview Modal -->
    <div id="emailModal" class="modal">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden m-4">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6">
                <div class="flex justify-between items-center">
                    <h3 id="emailModalTitle" class="text-xl font-bold">Email Preview</h3>
                    <button onclick="closeEmailModal()" class="text-white hover:text-gray-200">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div id="emailModalContent" class="mb-6">
                    <!-- Email content will be loaded here -->
                </div>
                <div class="flex justify-between">
                    <div class="space-x-2">
                        <button onclick="replyEmail()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition">
                            <i class="fas fa-reply mr-2"></i>Reply
                        </button>
                        <button onclick="forwardEmail()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">
                            <i class="fas fa-share mr-2"></i>Forward
                        </button>
                        <button onclick="deleteEmail()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition">
                            <i class="fas fa-trash mr-2"></i>Delete
                        </button>
                    </div>
                    <button onclick="closeEmailModal()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Email Templates with updated phone number
        const emailTemplates = {
            welcome: {
                subject: "Welcome to OOES - Your Office Efficiency Journey Begins!",
                body: `Dear [Client Name],

Welcome to OOES (Office Operations Efficiency Solution)!

Thank you for choosing us to transform your office operations. We're excited to help you save up to 50% of your admin time so you can focus on growing your business.

What happens next:
• Account setup within 24 hours
• Personalized onboarding session
• Custom workflow configuration
• Team training and support

Your dedicated account manager will contact you shortly to schedule your onboarding session.

Best regards,
The OOES Team
+254 717 261 425
contact@ooes.co.ke`
            },
            followup: {
                subject: "Following up on our discussion",
                body: `Dear [Client Name],

I hope this email finds you well. Following up on our recent conversation regarding [specific topic].

I wanted to:
• Reiterate our key discussion points
• Confirm next steps
• Answer any additional questions

As discussed, OOES can help you [specific benefit]. Our clients typically see [specific result] within [timeframe].

Would you be available for a brief call this week to finalize details?

Best regards,
[Your Name]
OOES Consultant
+254 717 261 425
contact@ooes.co.ke`
            },
            invoice: {
                subject: "Invoice [Invoice Number] - OOES Services",
                body: `Dear [Client Name],

Please find attached invoice [Invoice Number] for OOES services provided from [start date] to [end date].

Invoice Details:
• Service Period: [dates]
• Total Amount: KSh [amount]
• Due Date: [due date]
• Payment Methods: Bank transfer, M-Pesa, PayPal

For any questions about this invoice, please don't hesitate to contact us.

Thank you for your business!
OOES Finance Team
+254 717 261 425
contact@ooes.co.ke`
            },
            meeting: {
                subject: "Meeting Request - OOES Consultation",
                body: `Dear [Client Name],

I'd like to schedule a meeting to discuss [meeting purpose].

Proposed meeting details:
• Date: [suggested date]
• Time: [suggested time]
• Duration: 30 minutes
• Location: Zoom/In-person/Phone

Agenda:
1. Current challenges discussion
2. OOES solution overview
3. Implementation timeline
4. Q&A session

Please let me know if this time works or suggest an alternative.

Looking forward to our discussion!

Best regards,
[Your Name]
OOES Consultant
+254 717 261 425
contact@ooes.co.ke`
            }
        };

        // Email Functions
        function useTemplate(templateName) {
            const template = emailTemplates[templateName];
            if (template) {
                document.getElementById('subject').value = template.subject;
                document.getElementById('emailBody').innerHTML = template.body.replace(/\n/g, '<br>');
            }
        }

        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('emailBody').focus();
        }

        function addLink() {
            const url = prompt('Enter URL:');
            if (url) {
                document.execCommand('createLink', false, url);
                document.getElementById('emailBody').focus();
            }
        }

        function addImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.execCommand('insertImage', false, e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function addAttachment() {
            const input = document.createElement('input');
            input.type = 'file';
            input.multiple = true;
            input.onchange = function(e) {
                handleAttachments(e.target.files);
            };
            input.click();
        }

        function handleAttachments(files) {
            const attachmentsDiv = document.getElementById('attachments');
            const attachmentList = document.getElementById('attachmentList');
            
            if (files.length > 0) {
                attachmentsDiv.classList.remove('hidden');
                attachmentList.innerHTML = '';
                
                Array.from(files).forEach(file => {
                    const attachmentItem = document.createElement('div');
                    attachmentItem.className = 'flex items-center justify-between p-2 bg-gray-50 rounded';
                    attachmentItem.innerHTML = `
                        <div class="flex items-center">
                            <i class="fas fa-paperclip text-gray-500 mr-2"></i>
                            <span class="text-sm">${file.name}</span>
                            <span class="text-xs text-gray-500 ml-2">(${formatFileSize(file.size)})</span>
                        </div>
                        <button onclick="this.parentElement.remove()" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    attachmentList.appendChild(attachmentItem);
                });
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function sendEmail() {
            const to = document.getElementById('toEmail').value;
            const subject = document.getElementById('subject').value;
            const body = document.getElementById('emailBody').innerHTML;
            
            if (!to || !subject || !body) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(to)) {
                showNotification('Please enter a valid email address', 'error');
                return;
            }
            
            // Show sending notification
            showNotification('Sending email...', 'info');
            
            // Simulate sending email
            setTimeout(() => {
                showNotification(`Email sent successfully to ${to}!`, 'success');
                
                // Clear form
                document.getElementById('emailForm').reset();
                document.getElementById('emailBody').innerHTML = '';
                document.getElementById('attachments').classList.add('hidden');
                
                // Clear draft
                localStorage.removeItem('emailDraft');
            }, 1500);
        }

        function saveDraft() {
            const draft = {
                to: document.getElementById('toEmail').value,
                subject: document.getElementById('subject').value,
                body: document.getElementById('emailBody').innerHTML,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('emailDraft', JSON.stringify(draft));
            showNotification('Draft saved successfully!', 'success');
        }

        function checkEmail() {
            showNotification('Checking for new emails...', 'info');
            setTimeout(() => {
                const newEmails = Math.floor(Math.random() * 5) + 1;
                showNotification(`Found ${newEmails} new email${newEmails > 1 ? 's' : ''}!`, 'success');
            }, 2000);
        }

        function composeNew() {
            document.getElementById('emailForm').reset();
            document.getElementById('emailBody').innerHTML = '';
            document.getElementById('emailBody').focus();
            showNotification('New email composer ready', 'success');
        }

        function viewCalendar() {
            showNotification('Opening calendar integration...', 'info');
            setTimeout(() => {
                window.open('calendar-system.html', '_blank');
            }, 1000);
        }

        function openEmail(emailId) {
            const modal = document.getElementById('emailModal');
            const modalTitle = document.getElementById('emailModalTitle');
            const modalContent = document.getElementById('emailModalContent');
            
            // Simulate email content
            modalTitle.textContent = 'Email Preview';
            modalContent.innerHTML = `
                <div class="space-y-4">
                    <div class="border-b pb-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-semibold">From: contact@ooes.co.ke</p>
                                <p class="text-sm text-gray-600">To: client@example.com</p>
                                <p class="text-sm text-gray-600">Subject: Sample Email Subject</p>
                            </div>
                            <p class="text-sm text-gray-500">Today at 2:30 PM</p>
                        </div>
                    </div>
                    <div class="prose max-w-none">
                        <p>This is a sample email content. In a real implementation, this would display the actual email content with proper formatting, images, and attachments.</p>
                        <p>OOES provides comprehensive email management with professional templates and automated responses.</p>
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function closeEmailModal() {
            document.getElementById('emailModal').classList.remove('active');
        }

        function replyEmail() {
            closeEmailModal();
            document.getElementById('toEmail').value = 'client@example.com';
            document.getElementById('subject').value = 'Re: Sample Email Subject';
            document.getElementById('emailBody').focus();
        }

        function forwardEmail() {
            closeEmailModal();
            document.getElementById('subject').value = 'Fwd: Sample Email Subject';
            document.getElementById('emailBody').innerHTML = '<br><br>---------- Forwarded message ----------<br>Sample email content here';
            document.getElementById('emailBody').focus();
        }

        function deleteEmail() {
            if (confirm('Are you sure you want to delete this email?')) {
                closeEmailModal();
                showNotification('Email deleted successfully!', 'success');
            }
        }

        // Navigation functions for new layout
        function focusCompose() {
            document.getElementById('composeSection').scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => {
                document.getElementById('toEmail').focus();
            }, 500);
        }

        function scrollToTemplates() {
            document.getElementById('templatesSection').scrollIntoView({ behavior: 'smooth' });
        }

        function viewEmailAnalytics() {
            showNotification('Opening email analytics...', 'info');
            // Create analytics modal similar to index.html
            const modal = createModal('Email Analytics', `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h5 class="font-semibold text-blue-800">Total Sent</h5>
                                <i class="fas fa-paper-plane text-blue-600"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-600">1,823</div>
                            <div class="text-sm text-blue-600">+12% from last month</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h5 class="font-semibold text-green-800">Open Rate</h5>
                                <i class="fas fa-envelope-open text-green-600"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-600">78%</div>
                            <div class="text-sm text-green-600">+5% from last month</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h5 class="font-semibold text-purple-800">Response Rate</h5>
                                <i class="fas fa-reply text-purple-600"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-600">45%</div>
                            <div class="text-sm text-purple-600">+8% from last month</div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-3">Recent Performance</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Today</span>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">45 sent</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Yesterday</span>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: 60%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">38 sent</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">This Week</span>
                                <div class="flex items-center">
                                    <div class="w-32 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-purple-600 h-2 rounded-full" style="width: 85%"></div>
                                    </div>
                                    <span class="text-sm font-semibold">234 sent</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between">
                        <button onclick="exportEmailReport()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
                            <i class="fas fa-download mr-2"></i>Export Report
                        </button>
                        <button onclick="closeModal(this)" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition">
                            <i class="fas fa-times mr-2"></i>Close
                        </button>
                    </div>
                </div>
            `);
            
            document.body.appendChild(modal);
        }

        function createModal(title, content) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden m-4">
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold">${title}</h3>
                            <button onclick="closeModal(this)" class="text-white hover:text-gray-200">
                                <i class="fas fa-times text-2xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-6 overflow-y-auto max-h-[70vh]">
                        ${content}
                    </div>
                </div>
            `;
            return modal;
        }

        function closeModal(button) {
            const modal = button.closest('.fixed');
            if (modal) {
                modal.remove();
            }
        }

        function exportEmailReport() {
            showNotification('Generating email report...', 'info');
            setTimeout(() => {
                showNotification('Email report downloaded successfully', 'success');
            }, 2000);
        }

        // Quick Actions Functions
        function checkEmail(button) {
            // Add visual feedback to button
            button.classList.add('opacity-75', 'scale-95');
            showNotification('Checking for new emails...', 'info');
            
            // Simulate email checking
            setTimeout(() => {
                const newEmails = Math.floor(Math.random() * 5) + 1;
                showNotification(`Found ${newEmails} new email${newEmails > 1 ? 's' : ''}!`, 'success');
                button.classList.remove('opacity-75', 'scale-95');
                
                // Update inbox count
                const inboxCount = document.querySelector('.font-bold.text-blue-600');
                if (inboxCount) {
                    inboxCount.textContent = parseInt(inboxCount.textContent) + newEmails;
                }
            }, 2000);
        }

        function composeNew(button) {
            // Add visual feedback to button
            button.classList.add('opacity-75', 'scale-95');
            showNotification('Opening new email composer...', 'info');
            
            // Clear form and focus on recipient field
            document.getElementById('emailForm').reset();
            setTimeout(() => {
                document.getElementById('toEmail').focus();
                button.classList.remove('opacity-75', 'scale-95');
                showNotification('Ready to compose new email', 'success');
            }, 800);
        }

        function viewCalendar(button) {
            // Add visual feedback to button
            button.classList.add('opacity-75', 'scale-95');
            showNotification('Opening calendar...', 'info');
            
            // Open calendar system in new window
            setTimeout(() => {
                window.open('calendar-system.html', '_blank', 'width=1400,height=900');
                button.classList.remove('opacity-75', 'scale-95');
            }, 1000);
        }

        // Notification function
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            } text-white`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'} mr-3"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Add CSS for button animations
        const style = document.createElement('style');
        style.textContent = `
            .scale-95 {
                transform: scale(0.95);
            }
            
            .opacity-75 {
                opacity: 0.75;
            }
            
            .transition-all {
                transition: all 0.2s ease;
            }
        `;
        document.head.appendChild(style);

        // Go back to main dashboard
        function goBack() {
            window.location.href = 'index.html';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved draft if exists
            const savedDraft = localStorage.getItem('emailDraft');
            if (savedDraft) {
                const draft = JSON.parse(savedDraft);
                document.getElementById('toEmail').value = draft.to || '';
                document.getElementById('subject').value = draft.subject || '';
                document.getElementById('emailBody').innerHTML = draft.body || '';
            }
        });
    </script>
</body>
</html>
